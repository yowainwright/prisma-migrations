---
import SIDEBAR from "../../constants/sidebar";

let currentPath = Astro.url.pathname;
let prevItem, nextItem;
let currentSectionIndex: number, currentItemIndex: number;

SIDEBAR.forEach((item, index) => {
  if (
    item.items &&
    item.items.some((subItem) => subItem.href === currentPath)
  ) {
    currentSectionIndex = index;
    currentItemIndex = item.items.findIndex(
      (subItem) => subItem.href === currentPath
    );
    return;
  }
});

if (currentSectionIndex !== undefined) {
  if (currentItemIndex > 0) {
    prevItem = SIDEBAR[currentSectionIndex].items[currentItemIndex - 1];
  } else if (currentSectionIndex > 0) {
    prevItem = SIDEBAR[currentSectionIndex - 1].items.slice(-1)[0];
  } else {
    prevItem = undefined;
  }

  if (currentItemIndex < SIDEBAR[currentSectionIndex].items.length - 1) {
    nextItem = SIDEBAR[currentSectionIndex].items[currentItemIndex + 1];
  } else if (currentSectionIndex < SIDEBAR.length - 1) {
    nextItem = SIDEBAR[currentSectionIndex + 1].items[0];
  } else {
    nextItem = undefined;
  }
} else {
  prevItem = nextItem = undefined;
}
---

<div class="flex gap-4">
  {
    prevItem?.href && (
      <a href={prevItem?.href}>
        <button class="btn btn-ghost text-base px-4 py-1 h-12 whitespace-nowrap border-0 shadow-none outline-none hover:bg-primary/10 transition">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20">
            <path
              fill="currentColor"
              d="M16.707 19.293 9.414 12l7.293-7.293-1.414-1.414L6.586 12l8.707 8.707 1.414-1.414z"
            />
          </svg>
          <span>{prevItem?.title}</span>
        </button>
      </a>
    )
  }

  {
    nextItem?.href && (
      <a class="ml-auto" href={nextItem?.href}>
        <button class="btn btn-ghost text-base px-4 py-1 h-12 whitespace-nowrap border-0 shadow-none outline-none hover:bg-primary/10 transition">
          <span>{nextItem?.title}</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20">
            <path
              fill="currentColor"
              d="M7.293 4.707 14.586 12l-7.293 7.293 1.414 1.414L17.414 12 8.707 3.293 7.293 4.707z"
            />
          </svg>
        </button>
      </a>
    )
  }
</div>
